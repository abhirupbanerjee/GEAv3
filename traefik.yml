# ============================================
# TRAEFIK STATIC CONFIGURATION
# ============================================
#
# This file configures Traefik's core settings:
# - Entry points (HTTP/HTTPS ports)
# - SSL certificate resolver
# - Docker provider for dynamic routing
# - API dashboard
# - Logging
#
# Documentation: https://doc.traefik.io/traefik/
#
# ============================================

# ==========================================
# API & DASHBOARD
# ==========================================
api:
  # Enable the dashboard
  dashboard: true
  
  # Disable insecure access (use HTTPS only)
  insecure: false

# ==========================================
# ENTRY POINTS
# ==========================================
entryPoints:
  
  # HTTP Entry Point (Port 80)
  web:
    address: ":80"
    http:
      # Redirect all HTTP to HTTPS
      redirections:
        entryPoint:
          to: websecure
          scheme: https
          permanent: true
  
  # HTTPS Entry Point (Port 443)
  websecure:
    address: ":443"
    http:
      tls:
        # Use Let's Encrypt for SSL certificates
        certResolver: letsencrypt

# ==========================================
# SSL CERTIFICATE RESOLVER
# ==========================================
certificatesResolvers:
  
  letsencrypt:
    acme:
      # Email for Let's Encrypt notifications
      email: mailabhirupbanerjee@gmail.com
      
      # Storage location for certificates
      storage: /acme/acme.json
      
      # HTTP challenge for domain verification
      httpChallenge:
        entryPoint: web

# ==========================================
# PROVIDERS
# ==========================================
providers:
  
  # Docker provider for automatic service discovery
  docker:
    # Docker socket location
    endpoint: "unix:///var/run/docker.sock"
    
    # Only expose containers with traefik.enable=true label
    exposedByDefault: false
    
    # Network to use for container communication
    network: gogeaportal_gog_network

# ==========================================
# LOGGING
# ==========================================
log:
  # Log level: DEBUG, INFO, WARN, ERROR
  level: INFO
  
  # Log file location
  filePath: /var/log/traefik/traefik.log
  
  # Log format: json or common
  # format: json

# ==========================================
# ACCESS LOGS
# ==========================================
accessLog:
  # Access log file location
  filePath: /var/log/traefik/access.log
  
  # Log format: json or common
  # format: json
  
  # Fields to include in logs
  # fields:
  #   defaultMode: keep
  #   headers:
  #     defaultMode: drop

# ==========================================
# ADDITIONAL CONFIGURATION
# ==========================================

# Uncomment for development/debugging
# log:
#   level: DEBUG

# Uncomment to enable metrics
# metrics:
#   prometheus:
#     buckets:
#       - 0.1
#       - 0.3
#       - 1.2
#       - 5.0

# ==========================================
# NOTES
# ==========================================
#
# SECURITY:
# - Dashboard is protected via Basic Auth (configured in docker-compose)
# - All HTTP traffic redirected to HTTPS
# - SSL certificates auto-renewed by Let's Encrypt
#
# MONITORING:
# - Access dashboard at: https://traefik.your-domain.com
# - Check logs at: /var/log/traefik/
# - View certificates at: /acme/acme.json
#
# TROUBLESHOOTING:
# - Certificate issues: Check email for Let's Encrypt notifications
# - Routing issues: Enable DEBUG logging and check traefik.log
# - Permission issues: Ensure Docker socket is accessible
#
# ==========================================
